<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hobby Circle â€” Feed</title>
  <style>
  /* å¹³æ»‘æ»šåŠ¨ */
  html{
    scroll-behavior: smooth;
  }
    :root{--accent:#2b8cff;--bg:#f7f9fc;--card:#ffffff;--muted:#6b7280}
    body{margin:0;font-family:Inter,Segoe UI,Helvetica,Arial;background:var(--bg);color:#111}
    header{background:linear-gradient(90deg,#fff 0%,rgba(255,255,255,0.8) 100%);padding:14px 22px;display:flex;align-items:center;gap:14px}
    nav{margin-left:auto;display:flex;gap:12px}
    main{padding:18px 22px;padding-bottom:80px}
    .post{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 4px 12px rgba(16,24,40,0.04);margin-bottom:16px;max-width:800px;margin-left:auto;margin-right:auto;position:relative}
    .feed-header{max-width:800px;margin-left:auto;margin-right:auto;margin-bottom:24px}
    .feed-nav{display:flex;gap:12px;margin-top:16px;background:white;padding:6px;border-radius:8px;box-shadow:0 2px 8px rgba(16,24,40,0.04)}
    .nav-btn{flex:1;padding:10px 16px;border:none;background:transparent;color:var(--muted);border-radius:6px;cursor:pointer;transition:all 0.2s ease}
    .nav-btn:hover{background:var(--bg)}
    .nav-btn.active{background:var(--accent);color:white}
    .feed-content{max-width:800px;margin-left:auto;margin-right:auto}
    .feed-tab{display:none}
    .feed-tab.active{display:block}
    .feed-tab h3{color:#333;margin-bottom:16px}
    .post img{max-width:100%;height:auto;border-radius:8px;margin-top:8px;display:block}
    .btn{background:var(--accent);color:#fff;padding:8px 12px;border-radius:8px;text-decoration:none}
    /* æœç´¢æ æ ·å¼ */
    .search-container{max-width:800px;margin:0 auto 20px auto;position:relative}
    .search-input{width:100%;padding:12px 16px 12px 40px;border:1px solid #e6eef9;border-radius:8px;font-size:14px;background:white;box-shadow:0 2px 8px rgba(16,24,40,0.04);transition:border-color 0.2s ease}
    .search-input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(43,140,255,0.1)}
    .search-icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--muted)}
    /* ä¸‹æ‹‰åˆ·æ–°æ ·å¼ */
    .pull-refresh{display:flex;justify-content:center;align-items:center;height:0;overflow:hidden;transition:height 0.3s ease}
    .pull-refresh.active{height:50px}
    .refresh-icon{font-size:20px;color:var(--accent);transition:transform 0.3s ease}
    .refresh-icon.spinning{animation:spin 1s linear infinite}
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
    /* æ”¶è—æŒ‰é’®æ ·å¼ */
    .favorite-btn{position:absolute;top:12px;right:12px;background:transparent;border:none;font-size:20px;cursor:pointer;color:var(--muted);transition:all 0.2s ease;padding:4px}
    .favorite-btn:hover{transform:scale(1.1)}
    .favorite-btn.favorited{color:#ffd700}
    /* åº•éƒ¨æ¶ˆæ¯æ æ ·å¼ */
    .message-bar{position:fixed;bottom:0;left:0;right:0;background:white;display:flex;align-items:center;justify-content:space-around;padding:12px 22px;border-top:1px solid #e6eef9;box-shadow:0 -2px 10px rgba(0,0,0,0.05);z-index:100}
    .message-icon{position:relative}
    .message-icon .badge{position:absolute;top:-8px;right:-8px;background:#ff4757;color:white;font-size:12px;padding:2px 6px;border-radius:50%;min-width:16px;height:16px;display:flex;align-items:center;justify-content:center}
    .message-item{display:flex;align-items:center;gap:8px;padding:8px 16px;border-radius:8px;cursor:pointer;transition:background-color 0.2s ease}
    .message-item:hover{background:var(--bg)}
    /* åˆ›å»ºå¸–å­æŒ‰é’®æ ·å¼ */
    .create-post-btn{position:fixed;bottom:80px;right:22px;background:var(--accent);color:white;border:none;width:56px;height:56px;border-radius:50%;font-size:24px;cursor:pointer;box-shadow:0 4px 12px rgba(43,140,255,0.3);transition:all 0.2s ease}
    .create-post-btn:hover{transform:scale(1.1);background:#1a6fe0}
    .create-post-btn:active{transform:scale(0.95)}
    /* åˆ›å»ºå¸–å­æ¨¡æ€æ¡†æ ·å¼ */
    .modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center}
    .modal-content{background:white;padding:24px;border-radius:12px;max-width:600px;width:90%;max-height:80vh;overflow-y:auto}
    .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
    .modal-close{background:none;border:none;font-size:24px;cursor:pointer}
    .modal-body textarea{width:100%;padding:12px;border:1px solid #e6eef9;border-radius:8px;font-size:14px;resize:vertical;min-height:120px}
    .modal-footer{display:flex;justify-content:flex-end;gap:12px;margin-top:20px}
    .btn-secondary{background:#f3f4f6;color:#374151}
    .btn-secondary:hover{background:#e5e7eb}
    .post-actions {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 16px;
  margin-top: 12px;
}
.like-btn {
  background: transparent;
  color: var(--accent);
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 16px;
  padding: 4px;
}
.comment-count {
  color: var(--muted);
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 16px;
  cursor: pointer;
}
.comment-item {
  margin: 8px 0;
  padding: 10px 12px;
  border-radius: 8px;
  background: #f9f9f9;
  transition: background-color 0.2s ease;
}
.comment-item:hover {
  background: #f0f4ff;
}
.comment-user {
  font-weight: bold;
  color: var(--accent);
  margin-right: 8px;
}
.comment-content {
  color: #444;
  line-height: 1.4;
}
.comments-toggle {
  color: var(--accent);
  cursor: pointer;
  margin-top: 8px;
  font-size: 14px;
  user-select: none;
}
.comments-toggle:hover {
  text-decoration: underline;
}
.like-btn:hover {
  color: #1a6fe0;
}
.like-btn.liked {
  color: #ff4757;
}
.comment-section {
  margin-top: 12px;
  width: 100%;
}
.comment-input {
  width: calc(100% - 100px);
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 14px;
  transition: border-color 0.2s ease;
}
.comment-input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(43, 140, 255, 0.1);
}
.comment-submit {
  background: var(--accent);
  color: #fff;
  padding: 10px 16px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  transition: background-color 0.2s ease;
  font-size: 14px;
}
.comment-submit:hover {
  background: #1a6fe0;
}
.comment-submit:active {
  transform: scale(0.98);
}
.comments-list {
  margin-top: 12px;
  padding: 12px;
  background: #f5f5f5;
  border-radius: 8px;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
  max-height: 300px;
  overflow-y: auto;
  position: relative;
  scrollbar-width: thin;
  scrollbar-color: var(--accent) transparent;
}
.comments-list::-webkit-scrollbar {
  width: 6px;
}
.comments-list::-webkit-scrollbar-track {
  background: transparent;
}
.comments-list::-webkit-scrollbar-thumb {
  background-color: var(--accent);
  border-radius: 20px;
}
.scroll-to-bottom {
  position: absolute;
  right: 10px;
  bottom: 10px;
  background: var(--accent);
  color: white;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 2px 10px rgba(0,0,0,0.2);
  font-size: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  z-index: 100;
  border: none;
  outline: none;
  font-weight: bold;
}
.scroll-to-bottom:hover {
      background: #1a6fe0;
      transform: translateY(-2px);
    }
    .scroll-to-bottom:active {
      transform: translateY(0);
    }
    
    /* å“åº”å¼è®¾è®¡æ ·å¼ */
    @media (max-width:700px){
      header{padding:12px 16px;flex-wrap:wrap;justify-content:space-between}
      nav{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
      nav a{padding:6px 8px;font-size:14px}
      main{padding:12px 16px;padding-bottom:100px}
      .post{margin-bottom:12px}
      .feed-header{margin-bottom:16px}
      .feed-nav{gap:6px;padding:4px}
      .nav-btn{padding:8px 12px;font-size:14px}
      
      /* ä¿®å¤æœç´¢æ åœ¨ç§»åŠ¨ç«¯çš„æ˜¾ç¤º */
      .search-container{margin-bottom:16px}
      .search-input{padding:10px 12px 10px 36px;font-size:14px}
      
      /* ä¿®å¤åº•éƒ¨æ¶ˆæ¯æ åœ¨ç§»åŠ¨ç«¯çš„æ˜¾ç¤º */
      .message-bar{padding:8px 16px}
      .message-icon{font-size:18px}
      
      /* ä¿®å¤åˆ›å»ºå¸–å­æŒ‰é’®åœ¨ç§»åŠ¨ç«¯çš„æ˜¾ç¤º */
      .create-post-btn{bottom:70px;right:16px;width:48px;height:48px;font-size:20px}
      
      /* ä¿®å¤æ¨¡æ€æ¡†åœ¨ç§»åŠ¨ç«¯çš„æ˜¾ç¤º */
      .modal-content{width:95%;padding:16px;margin:16px}
      
      /* ä¿®å¤è¯„è®ºåŒºåŸŸåœ¨ç§»åŠ¨ç«¯çš„æ˜¾ç¤º */
      .comment-section{display:flex;flex-direction:column}
      .comment-input{width:100% !important;margin-bottom:8px}
      .comment-submit{width:100%}
      .comments-list{padding:10px;max-height:200px}
      
      /* ä¿®å¤å¸–å­æ“ä½œæŒ‰é’®åœ¨ç§»åŠ¨ç«¯çš„æ˜¾ç¤º */
      .post-actions{gap:12px}
      .like-btn, .comment-count{font-size:14px}
      
      /* ä¿®å¤æ»šåŠ¨åˆ°åº•éƒ¨æŒ‰é’®åœ¨ç§»åŠ¨ç«¯çš„æ˜¾ç¤º */
      .scroll-to-bottom{width:32px;height:32px;font-size:16px}
    }
    
    @media (max-width:480px){
      .post{padding:10px}
      .modal-content{padding:12px}
      .modal-header h3{font-size:18px}
      .nav-btn{padding:6px 8px;font-size:13px}
    }
.comment-item {
  margin: 8px 0;
  padding: 8px 10px;
  border-radius: 6px;
  background: white;
  border: 1px solid #eee;
}
.comments-toggle.active {
  background: rgba(43, 140, 255, 0.2);
  border-color: var(--accent);
}
  </style>
</head>
<body>
  <header>
    <div class="logo"><img src="images/logo.jpg" alt="logo" style="height:36px"></div>
    <strong>Hobby Circle</strong>
    <nav>
      <a href="index.html">Home</a>
      <a href="circles.html">Circles</a>
      <a class="active" href="feed.html">Feed</a>
      <a href="signup.html">Sign Up</a>
    </nav>
  </header>

  <main>
      <!-- ä¸‹æ‹‰åˆ·æ–°åŒºåŸŸ -->
      <div id="pull-refresh" class="pull-refresh">
        <span id="refresh-icon" class="refresh-icon">ğŸ”„</span>
      </div>
      
      <!-- æœç´¢æ  -->
      <div class="search-container">
        <span class="search-icon">ğŸ”</span>
        <input type="text" id="search-input" class="search-input" placeholder="Search posts, users or topics...">
      </div>
      
      <div class="feed-header">
        <h2>Feed</h2>
      <div class="feed-nav">
        <button class="nav-btn active" data-tab="following">Following</button>
        <button class="nav-btn" data-tab="discover">Discover</button>
        <button class="nav-btn" data-tab="nearby">Nearby Posts</button>
      </div>
    </div>
    
    <div class="feed-content">
      <div id="following-tab" class="feed-tab active">
        <h3>Following Content</h3>
    <section class="post">
      <button class="favorite-btn" data-post-id="post-1">â˜†</button>
      <div style="display: flex; align-items: center; gap: 8px;">
        <img src="images/user2.jpg" alt="Alice" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
        <strong>Alice</strong> <small style="color:var(--muted)">in Bakery Â· 2h</small>
      </div>
      <p>Just tried a new sourdough recipe â€” came out great!</p>
      <img src="images/sourdough.jpg" alt="sourdough">
      <div class="post-actions">
          <button class="like-btn" data-post-id="1">
            <span class="heart-icon">â¤</span>
            <span class="like-count">50</span>
          </button>
        <div class="comment-count" data-post-id="1">
            <span class="comment-icon">ğŸ’¬</span>
            <span class="count">20</span>
          </div>
      </div>
      <div class="comment-section">
          <input type="text" class="comment-input" placeholder="Add a comment..." data-post-id="1">
            <button class="comment-submit" data-post-id="1">Post Comment</button>
            <div class="comments-toggle" data-post-id="1">Show Comments (20)</div>
            <div class="comments-list" data-post-id="1" style="display: none;">
              <!-- è¯„è®ºå†…å®¹ - æ·»åŠ æ›´å¤šè¯„è®ºä»¥ç¡®ä¿æ»šåŠ¨æ¡å‡ºç° -->
              <div class="comment-item">
                <span class="comment-user">Charlie:</span>
                <span class="comment-content">Looks delicious! Can you share the recipe? ğŸ¥–</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Diana:</span>
                <span class="comment-content">Perfect crust color! How long did you ferment it?</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Ethan:</span>
                <span class="comment-content">Awesome! I just tried making one too, not as good as yours ğŸ˜Š</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Fiona:</span>
                <span class="comment-content">Must have a great sour aroma! ğŸ˜</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">George:</span>
                <span class="comment-content">The texture looks so fluffy, learned a lot!</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Lisa:</span>
                <span class="comment-content">This is exactly what I needed! Thank you for sharing. ğŸŒŸ</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">David:</span>
                <span class="comment-content">I have a question about the recipe. Can you explain more? â“</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Olivia:</span>
                <span class="comment-content">Beautiful work! The crust looks perfect. ğŸ’–</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">James:</span>
                <span class="comment-content">I tried this yesterday and it worked perfectly! Thanks! âœ…</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Sophia:</span>
                <span class="comment-content">Could you share more details about your process? ğŸ“</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Robert:</span>
                <span class="comment-content">This is going to save me so much time! ğŸ‰</span>
              </div>
              <button class="scroll-to-bottom" data-post-id="1">â–¼</button>
          </div>
        </div>
    </section>

    <section class="post">
      <button class="favorite-btn" data-post-id="post-2">â˜†</button>
      <div style="display: flex; align-items: center; gap: 8px;">
        <img src="images/user1.jpg" alt="Bob" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
        <strong>Bob</strong> <small style="color:var(--muted)">in Photography Â· 6h</small>
      </div>
      <p>Golden hour photos from last weekend.</p>
      <!-- ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„å›¾ç‰‡æ–‡ä»¶ -->
      <img src="images/glodenhour.jpg" alt="golden hour photo">
      <div class="post-actions">
          <button class="like-btn" data-post-id="2">
            <span class="heart-icon">â¤</span>
            <span class="like-count">100</span>
          </button>
        <div class="comment-count" data-post-id="2">
            <span class="comment-icon">ğŸ’¬</span>
            <span class="count">11</span>
          </div>
      </div>
      <div class="comment-section">
          <input type="text" class="comment-input" placeholder="Add a comment..." data-post-id="2">
            <button class="comment-submit" data-post-id="2">Post Comment</button>
            <div class="comments-toggle" data-post-id="2">Show Comments (11)</div>
            <div class="comments-list" data-post-id="2" style="display: none;">
              <!-- è¯„è®ºå†…å®¹ - æ·»åŠ æ›´å¤šè¯„è®ºä»¥ç¡®ä¿æ»šåŠ¨æ¡å‡ºç° -->
              <div class="comment-item">
                <span class="comment-user">Hannah:</span>
                <span class="comment-content">Perfectly captured the light! ğŸŒ‡</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Ian:</span>
                <span class="comment-content">Where was this taken? The view is amazing!</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Julia:</span>
                <span class="comment-content">Golden hour light is truly magical âœ¨</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Kevin:</span>
                <span class="comment-content">Great composition and depth!</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Lily:</span>
                <span class="comment-content">I love urban photography too, great angle selection! ğŸ“¸</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Lisa:</span>
                <span class="comment-content">This is exactly what I needed! Thank you for sharing. ğŸŒŸ</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">David:</span>
                <span class="comment-content">What camera settings did you use? I'd love to know! â“</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Olivia:</span>
                <span class="comment-content">Beautiful work! The lighting is incredible. ğŸ’–</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">James:</span>
                <span class="comment-content">I tried shooting at golden hour too, but mine don't look like this! âœ…</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Sophia:</span>
                <span class="comment-content">Could you share more of your photography tips? ğŸ“</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Robert:</span>
                <span class="comment-content">This is absolutely stunning! ğŸ‰</span>
              </div>
              <button class="scroll-to-bottom" data-post-id="2">â–¼</button>
          </div>
        </div>
    </section>
      </div>
      
      <div id="discover-tab" class="feed-tab">
        <h3>Discover New Content</h3>
        <section class="post">
          <button class="favorite-btn" data-post-id="discover-1">â˜†</button>
          <div style="display: flex; align-items: center; gap: 8px;">
            <img src="images/user5.jpg" alt="Emma" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
            <strong>Emma</strong> <small style="color:var(--muted)">in Art Â· 3h</small>
          </div>
          <p>Visited the new modern art exhibition downtown - amazing pieces!</p>
          <img src="images/art.jpg" alt="art exhibition">
          <div class="post-actions">
              <button class="like-btn" data-post-id="discover-1">
                <span class="heart-icon">â¤</span>
                <span class="like-count">143</span>
              </button>
            <div class="comment-count" data-post-id="discover-1">
                <span class="comment-icon">ğŸ’¬</span>
                <span class="count">2</span>
              </div>
          </div>
          <div class="comment-section">
            <input type="text" class="comment-input" placeholder="Add a comment..." data-post-id="discover-1">
            <button class="comment-submit" data-post-id="discover-1">Post Comment</button>
            <div class="comments-toggle" data-post-id="discover-1">Show Comments (2)</div>
            <div class="comments-list" data-post-id="discover-1" style="display: none;">
              <!-- è¯„è®ºå†…å®¹ -->
              <div class="comment-item">
                <span class="comment-user">John:</span>
                <span class="comment-content">Which exhibition is this? Looks fascinating!</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Sarah:</span>
                <span class="comment-content">Downtown Modern Art Museum - it's worth a visit!</span>
              </div>
              <button class="scroll-to-bottom" data-post-id="discover-1">â–¼</button>
            </div>
          </div>
        </section>
        
        <section class="post">
          <button class="favorite-btn" data-post-id="discover-2">â˜†</button>
          <div style="display: flex; align-items: center; gap: 8px;">
            <img src="images/user6.jpg" alt="Sophia" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
            <strong>Sophia</strong> <small style="color:var(--muted)">in Reading Â· 5h</small>
          </div>
          <p>Our monthly book recommendation - this novel will change your perspective!</p>
          <img src="images/readingclub.jpg" alt="book club">
          <div class="post-actions">
              <button class="like-btn" data-post-id="discover-2">
                <span class="heart-icon">â¤</span>
                <span class="like-count">89</span>
              </button>
            <div class="comment-count" data-post-id="discover-2">
                <span class="comment-icon">ğŸ’¬</span>
                <span class="count">2</span>
              </div>
          </div>
          <div class="comment-section">
            <input type="text" class="comment-input" placeholder="Add a comment..." data-post-id="discover-2">
            <button class="comment-submit" data-post-id="discover-2">Post Comment</button>
            <div class="comments-toggle" data-post-id="discover-2">Show Comments (2)</div>
            <div class="comments-list" data-post-id="discover-2" style="display: none;">
              <!-- è¯„è®ºå†…å®¹ -->
              <div class="comment-item">
                <span class="comment-user">Michael:</span>
                <span class="comment-content">What's the name of the book? Sounds interesting!</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Olivia:</span>
                <span class="comment-content">It's "The Song of Achilles" - a beautiful retelling!</span>
              </div>
              <button class="scroll-to-bottom" data-post-id="discover-2">â–¼</button>
            </div>
          </div>
        </section>
        
        <section class="post">
          <button class="favorite-btn" data-post-id="discover-3">â˜†</button>
          <div style="display: flex; align-items: center; gap: 8px;">
            <img src="images/user7.jpg" alt="Isabella" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
            <strong>Isabella</strong> <small style="color:var(--muted)">in Music Â· 1d</small>
          </div>
          <p>Just discovered this amazing indie band - check out their latest album!</p>
          <img src="images/music.jpg" alt="music album">
          <div class="post-actions">
              <button class="like-btn" data-post-id="discover-3">
                <span class="heart-icon">â¤</span>
                <span class="like-count">215</span>
              </button>
            <div class="comment-count" data-post-id="discover-3">
                <span class="comment-icon">ğŸ’¬</span>
                <span class="count">2</span>
              </div>
          </div>
          <div class="comment-section">
            <input type="text" class="comment-input" placeholder="Add a comment..." data-post-id="discover-3">
            <button class="comment-submit" data-post-id="discover-3">Post Comment</button>
            <div class="comments-toggle" data-post-id="discover-3">Show Comments (2)</div>
            <div class="comments-list" data-post-id="discover-3" style="display: none;">
              <!-- è¯„è®ºå†…å®¹ -->
              <div class="comment-item">
                <span class="comment-user">David:</span>
                <span class="comment-content">Which band is this? I'm always looking for new music!</span>
              </div>
              <div class="comment-item">
                <span class="comment-user">Emily:</span>
                <span class="comment-content">It's The Paper Kites - their latest album is fantastic!</span>
              </div>
              <button class="scroll-to-bottom" data-post-id="discover-3">â–¼</button>
            </div>
          </div>
        </section>
      </div>
      
      <div id="nearby-tab" class="feed-tab">
        <h3>Nearby Posts</h3>
        <section class="post">
          <div style="display: flex; align-items: center; gap: 8px;">
            <img src="images/user3.jpg" alt="John" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
            <strong>John</strong> <small style="color:var(--muted)">in Bakery Â· 1h Â· 500m away</small>
          </div>
          <p>Fresh bread available at our pop-up shop today!</p>
          <img src="images/backeryshop.jpg" alt="bakery shop" style="width: 100%; height: auto; object-fit: cover; max-height: 400px; border-radius: 8px;">
          <div class="post-actions">
              <button class="like-btn" data-post-id="3">
                <span class="heart-icon">â¤</span>
                <span class="like-count">24</span>
              </button>
            <div class="comment-count" data-post-id="3">
                <span class="comment-icon">ğŸ’¬</span>
                <span class="count">2</span>
              </div>
          </div>
          <div class="comment-section">
              <input type="text" class="comment-input" placeholder="Add a comment..." data-post-id="3">
                <button class="comment-submit" data-post-id="3">Post Comment</button>
                <div class="comments-toggle" data-post-id="3">Show Comments (2)</div>
                <div class="comments-list" data-post-id="3" style="display: none;">
                  <!-- è¯„è®ºå†…å®¹ -->
                  <div class="comment-item">
                    <span class="comment-user">Emma:</span>
                    <span class="comment-content">I'll be there! What time?</span>
                  </div>
                  <div class="comment-item">
                    <span class="comment-user">Thomas:</span>
                    <span class="comment-content">10am-4pm today!</span>
                  </div>
                  <button class="scroll-to-bottom" data-post-id="3">â–¼</button>
              </div>
            </div>
        </section>
        
        <section class="post">
          <div style="display: flex; align-items: center; gap: 8px;">
            <img src="images/user4.jpg" alt="Michael" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
            <strong>Michael</strong> <small style="color:var(--muted)">in Photography Â· 3h Â· 1.2km away</small>
          </div>
          <p>Just captured this amazing cityscape from the rooftop!</p>
          <img src="images/rooftop.jpg" alt="rooftop view" style="width: 100%; height: auto; object-fit: cover; max-height: 400px; border-radius: 8px;">
          <div class="post-actions">
              <button class="like-btn" data-post-id="4">
                <span class="heart-icon">â¤</span>
                <span class="like-count">78</span>
              </button>
            <div class="comment-count" data-post-id="4">
                <span class="comment-icon">ğŸ’¬</span>
                <span class="count">2</span>
              </div>
          </div>
          <div class="comment-section">
              <input type="text" class="comment-input" placeholder="Add a comment..." data-post-id="4">
                <button class="comment-submit" data-post-id="4">Post Comment</button>
                <div class="comments-toggle" data-post-id="4">Show Comments (2)</div>
                <div class="comments-list" data-post-id="4" style="display: none;">
                  <!-- è¯„è®ºå†…å®¹ -->
                  <div class="comment-item">
                    <span class="comment-user">James:</span>
                    <span class="comment-content">Wow! Where is this rooftop?</span>
                  </div>
                  <div class="comment-item">
                    <span class="comment-user">Sophia:</span>
                    <span class="comment-content">Downtown area, near Central Park.</span>
                  </div>
                  <button class="scroll-to-bottom" data-post-id="4">â–¼</button>
              </div>
            </div>
        </section>
      </div>
    </div>
  </main>
    
    <!-- åˆ›å»ºå¸–å­æŒ‰é’® -->
    <button id="create-post-btn" class="create-post-btn">+</button>
    
    <!-- åˆ›å»ºå¸–å­æ¨¡æ€æ¡† -->
    <div id="create-post-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Create New Post</h3>
          <button id="close-modal" class="modal-close">Ã—</button>
        </div>
        <div class="modal-body">
          <textarea id="post-content" placeholder="Share your thoughts..."></textarea>
          <div style="margin-top: 16px;">
            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Choose a Tag:</label>
            <div id="tag-container" style="display: flex; flex-wrap: wrap; gap: 8px;">
              <button class="tag-btn" data-tag="Bakery">Bakery</button>
              <button class="tag-btn" data-tag="Photography">Photography</button>
              <button class="tag-btn" data-tag="Music">Music</button>
              <button class="tag-btn" data-tag="Movies">Movies</button>
              <button class="tag-btn" data-tag="Reading Club">Reading Club</button>
              <button class="tag-btn" data-tag="Sports">Sports</button>
              <button class="tag-btn" data-tag="Art">Art</button>
            </div>
            <input type="hidden" id="selected-tag" value="">
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancel-post" class="btn btn-secondary">Cancel</button>
          <button id="submit-post" class="btn">Post</button>
        </div>
      </div>
    </div>
    
    <!-- åº•éƒ¨æ¶ˆæ¯æ  -->
    <div class="message-bar">
      <div class="message-item">
        <div class="message-icon">
          ğŸ’¬
        </div>
        <span>Messages</span>
      </div>
      <div class="message-item">
        <div class="message-icon">
          ğŸ””
        </div>
        <span>Notifications</span>
      </div>
      <div class="message-item">
        <div class="message-icon">â˜…</div>
        <span>Favorites</span>
      </div>
    </div>
  </div>
  </main>
    <script>
      // æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€å¹¶è·å–ç”¨æˆ·ä¿¡æ¯
      function checkUserLogin() {
        try {
          const isLoggedIn = localStorage.getItem('isLoggedIn');
          const userData = localStorage.getItem('currentUser');
          
          if (isLoggedIn === 'true' && userData) {
            const user = JSON.parse(userData);
            console.log('User logged in:', user.username);
            // è¿™é‡Œå¯ä»¥æ·»åŠ ä»£ç æ¥æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯åœ¨é¡µé¢ä¸Š
            return user;
          }
          
          // æ£€æŸ¥cookieä½œä¸ºå¤‡é€‰
          if (document.cookie.includes('user_logged_in=true')) {
            console.log('User logged in via cookie');
          }
        } catch (error) {
          console.error('Error checking login status:', error);
        }
        return null;
      }
      
      // é¡µé¢åŠ è½½æ—¶ç«‹å³æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€
      const currentUser = checkUserLogin();
      
      // ç”¨æˆ·å…´è¶£æ•°æ® - æ¨¡æ‹Ÿç”¨æˆ·æµè§ˆå†å²
      const userInterests = {
        'Bakery': 85,    // æµè§ˆé‡
        'Photography': 95,
        'Music': 60,
        'Movies': 70,
        'Reading Club': 50
      };
      
      // æ”¶è—çš„å¸–å­
      let favoritePosts = JSON.parse(localStorage.getItem('favoritePosts')) || [];
      
      // åˆå§‹åŒ–æ”¶è—æŒ‰é’®çŠ¶æ€
      function initFavoriteButtons() {
        document.querySelectorAll('.favorite-btn').forEach(btn => {
          const postId = btn.getAttribute('data-post-id');
          if (favoritePosts.includes(postId)) {
            btn.classList.add('favorited');
            btn.textContent = 'â˜…';
          }
          
          btn.addEventListener('click', function(e) {
            e.stopPropagation();
            toggleFavorite(this);
          });
        });
      }
      
      // åˆ‡æ¢æ”¶è—çŠ¶æ€
      function toggleFavorite(button) {
        const postId = button.getAttribute('data-post-id');
        
        if (button.classList.contains('favorited')) {
          // å–æ¶ˆæ”¶è—
          button.classList.remove('favorited');
          button.textContent = 'â˜†';
          favoritePosts = favoritePosts.filter(id => id !== postId);
          showNotification('Removed from favorites');
        } else {
          // æ·»åŠ æ”¶è—
          button.classList.add('favorited');
          button.textContent = 'â˜…';
          favoritePosts.push(postId);
          showNotification('Added to favorites');
        }
        
        // ä¿å­˜åˆ°localStorage
        localStorage.setItem('favoritePosts', JSON.stringify(favoritePosts));
      }
      
      // åˆå§‹åŒ–æœç´¢åŠŸèƒ½
      function initSearch() {
        const searchInput = document.getElementById('search-input');
        
        searchInput.addEventListener('input', function() {
          const searchTerm = this.value.toLowerCase();
          const posts = document.querySelectorAll('.post');
          
          posts.forEach(post => {
            const postText = post.textContent.toLowerCase();
            // æ ¹æ®å¸–å­å†…å®¹è¿›è¡Œæœç´¢
            if (postText.includes(searchTerm)) {
              post.style.display = 'block';
            } else {
              post.style.display = 'none';
            }
          });
        });
      }
      
      // ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½
      function initPullToRefresh() {
        const pullRefresh = document.getElementById('pull-refresh');
        const refreshIcon = document.getElementById('refresh-icon');
        let startY = 0;
        let isPulling = false;
        
        document.addEventListener('touchstart', function(e) {
          // åªæœ‰å½“é¡µé¢æ»šåŠ¨åˆ°é¡¶éƒ¨æ—¶æ‰å¯ç”¨ä¸‹æ‹‰åˆ·æ–°
          if (window.scrollY === 0) {
            startY = e.touches[0].clientY;
            isPulling = true;
          }
        }, {passive: true});
        
        document.addEventListener('touchmove', function(e) {
          if (!isPulling) return;
          
          const currentY = e.touches[0].clientY;
          const pullDistance = currentY - startY;
          
          // åªæœ‰ä¸‹æ‹‰æ‰è§¦å‘
          if (pullDistance > 0) {
            // é™åˆ¶æœ€å¤§ä¸‹æ‹‰è·ç¦»
            const maxPullDistance = 100;
            const distance = Math.min(pullDistance, maxPullDistance);
            
            // è°ƒæ•´ä¸‹æ‹‰åŒºåŸŸé«˜åº¦
            pullRefresh.style.height = (distance * 0.5) + 'px';
            
            // æ—‹è½¬å›¾æ ‡
            const rotation = (distance / maxPullDistance) * 180;
            refreshIcon.style.transform = `rotate(${rotation}deg)`;
            
            // å¦‚æœä¸‹æ‹‰è¶…è¿‡é˜ˆå€¼ï¼Œå¯ä»¥æ·»åŠ è§†è§‰æç¤º
            if (distance > maxPullDistance * 0.8) {
              refreshIcon.style.color = '#4caf50';
            } else {
              refreshIcon.style.color = 'var(--accent)';
            }
          }
        }, {passive: true});
        
        document.addEventListener('touchend', function() {
          if (!isPulling) return;
          
          const currentHeight = parseInt(pullRefresh.style.height || '0');
          
          // å¦‚æœä¸‹æ‹‰è¶³å¤Ÿè·ç¦»ï¼Œè§¦å‘åˆ·æ–°
          if (currentHeight > 40) {
            refreshIcon.classList.add('spinning');
            refreshIcon.style.transform = 'rotate(0deg)';
            
            // æ¨¡æ‹Ÿåˆ·æ–°æ“ä½œ
            const posts = document.querySelectorAll('.post');
            posts.forEach(post => {
              post.style.opacity = '0.5';
            });
            
            setTimeout(() => {
              // æ¢å¤å¸–å­æ˜¾ç¤º
              posts.forEach(post => {
                post.style.opacity = '1';
              });
              
              refreshIcon.classList.remove('spinning');
              pullRefresh.style.height = '0';
              
              // æ˜¾ç¤ºåˆ·æ–°æˆåŠŸçš„æç¤º
              showNotification('Feed refreshed!');
            }, 1000);
          } else {
            // å¦åˆ™å¼¹å›
            pullRefresh.style.height = '0';
            refreshIcon.style.transform = 'rotate(0deg)';
          }
          
          isPulling = false;
        });
        
        // ä¸ºæ¡Œé¢æµè§ˆå™¨æ·»åŠ é¼ æ ‡æ‹–æ‹½æ”¯æŒ
        let isDragging = false;
        
        document.addEventListener('mousedown', function(e) {
          if (window.scrollY === 0) {
            startY = e.clientY;
            isDragging = true;
          }
        });
        
        document.addEventListener('mousemove', function(e) {
          if (!isDragging) return;
          
          const currentY = e.clientY;
          const pullDistance = currentY - startY;
          
          if (pullDistance > 0) {
            const maxPullDistance = 100;
            const distance = Math.min(pullDistance, maxPullDistance);
            
            pullRefresh.style.height = (distance * 0.5) + 'px';
            const rotation = (distance / maxPullDistance) * 180;
            refreshIcon.style.transform = `rotate(${rotation}deg)`;
            
            refreshIcon.style.color = distance > maxPullDistance * 0.8 ? '#4caf50' : 'var(--accent)';
          }
        });
        
        document.addEventListener('mouseup', function() {
          if (!isDragging) return;
          
          const currentHeight = parseInt(pullRefresh.style.height || '0');
          
          if (currentHeight > 40) {
            refreshIcon.classList.add('spinning');
            refreshIcon.style.transform = 'rotate(0deg)';
            
            const posts = document.querySelectorAll('.post');
            posts.forEach(post => {
              post.style.opacity = '0.5';
            });
            
            setTimeout(() => {
              posts.forEach(post => {
                post.style.opacity = '1';
              });
              
              refreshIcon.classList.remove('spinning');
              pullRefresh.style.height = '0';
              showNotification('Feed refreshed!');
            }, 1000);
          } else {
            pullRefresh.style.height = '0';
            refreshIcon.style.transform = 'rotate(0deg)';
          }
          
          isDragging = false;
        });
      }
      
      // æ˜¾ç¤ºé€šçŸ¥å‡½æ•°
      function showNotification(message) {
        const notification = document.createElement('div');
        notification.textContent = message;
        notification.style.cssText = 'position: fixed; bottom: 80px; right: 20px; background: var(--accent); color: white; padding: 12px 16px; border-radius: 8px; z-index: 1000; box-shadow: 0 4px 12px rgba(0,0,0,0.15);';
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.style.opacity = '0';
          notification.style.transition = 'opacity 0.5s ease';
          setTimeout(() => {
            notification.remove();
          }, 500);
        }, 2000);
      }
      
      // åˆå§‹åŒ–åˆ›å»ºå¸–å­åŠŸèƒ½
      function initCreatePost() {
        const createBtn = document.getElementById('create-post-btn');
        const modal = document.getElementById('create-post-modal');
        const closeBtn = document.getElementById('close-modal');
        const cancelBtn = document.getElementById('cancel-post');
        const submitBtn = document.getElementById('submit-post');
        const postContent = document.getElementById('post-content');
        const tagButtons = document.querySelectorAll('.tag-btn');
        const selectedTagInput = document.getElementById('selected-tag');
        let selectedTagBtn = null;
        
        // æ ‡ç­¾æŒ‰é’®æ ·å¼
        tagButtons.forEach(btn => {
          btn.style.padding = '6px 12px';
          btn.style.border = '1px solid #e6eef9';
          btn.style.borderRadius = '16px';
          btn.style.backgroundColor = 'white';
          btn.style.color = '#333';
          btn.style.cursor = 'pointer';
          btn.style.transition = 'all 0.2s ease';
          btn.style.fontSize = '14px';
          
          btn.addEventListener('click', function() {
            // ç§»é™¤ä¹‹å‰é€‰ä¸­çš„æ ‡ç­¾æ ·å¼
            if (selectedTagBtn) {
              selectedTagBtn.style.backgroundColor = 'white';
              selectedTagBtn.style.color = '#333';
              selectedTagBtn.style.borderColor = '#e6eef9';
            }
            
            // è®¾ç½®æ–°é€‰ä¸­çš„æ ‡ç­¾æ ·å¼
            this.style.backgroundColor = 'var(--accent)';
            this.style.color = 'white';
            this.style.borderColor = 'var(--accent)';
            selectedTagBtn = this;
            selectedTagInput.value = this.getAttribute('data-tag');
          });
        });
        
        // æ‰“å¼€æ¨¡æ€æ¡†
        createBtn.addEventListener('click', function() {
          modal.style.display = 'flex';
          postContent.value = '';
          selectedTagInput.value = '';
          
          // é‡ç½®æ ‡ç­¾æŒ‰é’®æ ·å¼
          if (selectedTagBtn) {
            selectedTagBtn.style.backgroundColor = 'white';
            selectedTagBtn.style.color = '#333';
            selectedTagBtn.style.borderColor = '#e6eef9';
            selectedTagBtn = null;
          }
          
          // æ·»åŠ æ‰“å¼€åŠ¨ç”»
          const modalContent = modal.querySelector('.modal-content');
          modalContent.style.transform = 'scale(0.9)';
          modalContent.style.opacity = '0';
          modalContent.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
          
          setTimeout(() => {
            modalContent.style.transform = 'scale(1)';
            modalContent.style.opacity = '1';
          }, 10);
        });
        
        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
          const modalContent = modal.querySelector('.modal-content');
          modalContent.style.transform = 'scale(0.9)';
          modalContent.style.opacity = '0';
          
          setTimeout(() => {
            modal.style.display = 'none';
          }, 300);
        }
        
        closeBtn.addEventListener('click', closeModal);
        cancelBtn.addEventListener('click', closeModal);
        
        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        modal.addEventListener('click', function(e) {
          if (e.target === modal) {
            closeModal();
          }
        });
        
        // æäº¤å¸–å­
        submitBtn.addEventListener('click', function() {
          const content = postContent.value.trim();
          const tag = selectedTagInput.value;
          
          if (content && tag) {
            createNewPost(content, tag);
            closeModal();
          } else {
            showNotification('Please enter content and select a tag');
          }
        });
      }
      
      // åˆ›å»ºæ–°å¸–å­å¹¶æ·»åŠ åˆ°é¡µé¢
      function createNewPost(content, tag) {
        const feedTab = document.getElementById('following-tab');
        const postId = 'new-post-' + Date.now();
        
        // åˆ›å»ºæ–°å¸–å­å…ƒç´ 
        const newPost = document.createElement('section');
        newPost.className = 'post';
        newPost.style.opacity = '0';
        newPost.style.transform = 'translateY(20px)';
        newPost.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
        
        // æ„å»ºå¸–å­HTML
        newPost.innerHTML = `
          <button class="favorite-btn" data-post-id="${postId}">â˜†</button>
          <div style="display: flex; align-items: center; gap: 8px;">
            <img src="images/user1.jpg" alt="You" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
            <strong>You</strong> <small style="color:var(--muted)">in ${tag} Â· Just now</small>
          </div>
          <p>${content}</p>
          <div class="post-actions">
              <button class="like-btn" data-post-id="${postId}">
                <span class="heart-icon">â¤</span>
                <span class="like-count">0</span>
              </button>
            <div class="comment-count" data-post-id="${postId}">
                <span class="comment-icon">ğŸ’¬</span>
                <span class="count">0</span>
              </div>
          </div>
          <div class="comment-section">
              <input type="text" class="comment-input" placeholder="Add a comment..." data-post-id="${postId}">
                <button class="comment-submit" data-post-id="${postId}">Post Comment</button>
                <div class="comments-toggle" data-post-id="${postId}">Show Comments (0)</div>
                <div class="comments-list" data-post-id="${postId}" style="display: none;">
                  <button class="scroll-to-bottom" data-post-id="${postId}">â–¼</button>
              </div>
            </div>
        `;
        
        // å°†æ–°å¸–å­æ·»åŠ åˆ°é¡¶éƒ¨
        const firstPost = feedTab.querySelector('.post');
        if (firstPost) {
          feedTab.insertBefore(newPost, firstPost);
        } else {
          feedTab.appendChild(newPost);
        }
        
        // è§¦å‘åŠ¨ç”»
        setTimeout(() => {
          newPost.style.opacity = '1';
          newPost.style.transform = 'translateY(0)';
        }, 10);
        
        // åˆå§‹åŒ–æ–°å¸–å­çš„äº‹ä»¶
        updateCommentFeatures();
        initFavoriteButtons();
        
        // æ˜¾ç¤ºæˆåŠŸé€šçŸ¥
        showNotification('Post created successfully!');
      }
      
      // åˆå§‹åŒ–åº•éƒ¨æ¶ˆæ¯æ 
      function initMessageBar() {
        console.log('Initializing message bar...');
        const messageItems = document.querySelectorAll('.message-bar .message-item');
        let activePanel = null;
        
        console.log('Message items found:', messageItems.length);
        
        // ä¸ºæ¶ˆæ¯æ æ·»åŠ æ ·å¼ï¼Œç¡®ä¿å®ƒåœ¨åº•éƒ¨å›ºå®šæ˜¾ç¤º
        const messageBar = document.querySelector('.message-bar');
        if (messageBar) {
          messageBar.style.position = 'fixed';
          messageBar.style.bottom = '0';
          messageBar.style.left = '0';
          messageBar.style.right = '0';
          messageBar.style.display = 'flex';
          messageBar.style.justifyContent = 'space-around';
          messageBar.style.backgroundColor = 'white';
          messageBar.style.borderTop = '1px solid #e6eef9';
          messageBar.style.padding = '12px 0';
          messageBar.style.zIndex = '98';
          messageBar.style.boxShadow = '0 -1px 3px rgba(0,0,0,0.05)';
        }
        
        // åˆ›å»ºæ¶ˆæ¯é¢æ¿
        function createMessagePanel(type) {
          console.log('Creating message panel for:', type);
          const panel = document.createElement('div');
          panel.className = 'message-panel';
          panel.id = `${type}-panel`;
          panel.style.position = 'fixed';
          panel.style.bottom = '70px';
          panel.style.left = '0';
          panel.style.right = '0';
          panel.style.backgroundColor = 'white';
          panel.style.borderTop = '1px solid #e6eef9';
          panel.style.boxShadow = '0 -2px 10px rgba(0,0,0,0.1)';
          panel.style.maxHeight = '70vh';
          panel.style.display = 'none'; // åˆå§‹éšè—ï¼Œç‚¹å‡»æ—¶æ˜¾ç¤º
          panel.style.zIndex = '99';
          panel.style.overflow = 'hidden';
          panel.style.opacity = '1';
          panel.style.transform = 'translateY(0)';
          panel.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
          
          // é¢æ¿å¤´éƒ¨
          const header = document.createElement('div');
          header.style.padding = '16px 22px';
          header.style.borderBottom = '1px solid #eee';
          header.style.display = 'flex';
          header.style.justifyContent = 'space-between';
          header.style.alignItems = 'center';
          
          const title = document.createElement('h3');
          title.style.margin = '0';
          title.style.fontSize = '18px';
          
          const closeBtn = document.createElement('button');
          closeBtn.textContent = 'Ã—';
          closeBtn.style.background = 'none';
          closeBtn.style.border = 'none';
          closeBtn.style.fontSize = '24px';
          closeBtn.style.cursor = 'pointer';
          closeBtn.style.color = 'var(--muted)';
          
          // é¢æ¿å†…å®¹åŒºåŸŸ
          const content = document.createElement('div');
          content.className = 'panel-content';
          content.style.padding = '16px 22px';
          content.style.overflowY = 'auto';
          content.style.maxHeight = 'calc(70vh - 70px)';
          
          // æ ¹æ®ç±»å‹è®¾ç½®å†…å®¹
          if (type === 'Messages') {
            title.textContent = 'Messages';
            content.innerHTML = `
              <div class="message-conversation">
                <div class="message-user" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; cursor: pointer; transition: background-color 0.2s ease;">
                  <img src="images/user2.jpg" alt="Alice" style="width: 48px; height: 48px; border-radius: 50%; object-fit: cover;">
                  <div>
                    <div style="font-weight: bold; display: flex; justify-content: space-between; align-items: center;">
                      <span>Alice <span style="display: inline-block; width: 8px; height: 8px; background-color: #10b981; border-radius: 50%; margin-left: 6px;"></span></span>
                      <span style="font-size: 12px; color: var(--muted);">2h</span>
                    </div>
                    <div style="font-size: 14px; color: #333;">Great sourdough recipe! Can you share it?</div>
                  </div>
                </div>
                <div class="message-user" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; cursor: pointer; transition: background-color 0.2s ease; margin-top: 8px;">
                  <img src="images/user3.jpg" alt="Charlie" style="width: 48px; height: 48px; border-radius: 50%; object-fit: cover;">
                  <div>
                    <div style="font-weight: bold; display: flex; justify-content: space-between; align-items: center;">
                      <span>Charlie</span>
                      <span style="font-size: 12px; color: var(--muted);">5h</span>
                    </div>
                    <div style="font-size: 14px; color: #333;">Are you joining the photography meetup this Saturday?</div>
                  </div>
                </div>
                <div class="message-user" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; cursor: pointer; transition: background-color 0.2s ease; margin-top: 8px;">
                  <img src="images/user4.jpg" alt="Diana" style="width: 48px; height: 48px; border-radius: 50%; object-fit: cover;">
                  <div>
                    <div style="font-weight: bold; display: flex; justify-content: space-between; align-items: center;">
                      <span>Diana <span style="display: inline-block; width: 8px; height: 8px; background-color: #10b981; border-radius: 50%; margin-left: 6px;"></span></span>
                      <span style="font-size: 12px; color: var(--muted);">Yesterday</span>
                    </div>
                    <div style="font-size: 14px; color: var(--muted);">Thanks for the book recommendation! I just finished reading it and loved it.</div>
                  </div>
                </div>
              </div>
            `;
          } else if (type === 'Notifications') {
            title.textContent = 'Notifications';
            content.innerHTML = `
              <div class="notification-item" style="padding: 12px; border-radius: 8px; transition: background-color 0.2s ease;">
                <div style="display: flex; gap: 12px;">
                  <img src="images/user5.jpg" alt="Pro Baker" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                  <div>
                    <div style="font-weight: bold;">Pro Baker</div>
                    <div style="font-size: 14px; color: #333;">liked your post about sourdough baking</div>
                    <div style="font-size: 12px; color: var(--muted);">10 minutes ago</div>
                  </div>
                </div>
              </div>
              <div class="notification-item" style="padding: 12px; border-radius: 8px; transition: background-color 0.2s ease; margin-top: 8px;">
                <div style="display: flex; gap: 12px;">
                  <img src="images/user6.jpg" alt="Macro Photographer" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                  <div>
                    <div style="font-weight: bold;">Macro Photographer</div>
                    <div style="font-size: 14px; color: #333;">commented on your photo: "Amazing composition!"</div>
                    <div style="font-size: 12px; color: var(--muted);">1 hour ago</div>
                  </div>
                </div>
              </div>
              <div class="notification-item" style="padding: 12px; border-radius: 8px; transition: background-color 0.2s ease; margin-top: 8px;">
                <div style="display: flex; gap: 12px;">
                  <img src="images/user7.jpg" alt="Acoustic Guitarist" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                  <div>
                    <div style="font-weight: bold;">Acoustic Guitarist</div>
                    <div style="font-size: 14px; color: #333;">mentioned you in a comment: "@You should check this out!"</div>
                    <div style="font-size: 12px; color: var(--muted);">3 hours ago</div>
                  </div>
                </div>
              </div>
              <div class="notification-item" style="padding: 12px; border-radius: 8px; transition: background-color 0.2s ease; margin-top: 8px;">
                <div style="display: flex; gap: 12px;">
                  <div style="width: 40px; height: 40px; border-radius: 50%; background-color: var(--accent); display: flex; align-items: center; justify-content: center; color: white;">ğŸ“¢</div>
                  <div>
                    <div style="font-weight: bold;">System</div>
                    <div style="font-size: 14px; color: #333;">New circle "Digital Art" is now available for joining</div>
                    <div style="font-size: 12px; color: var(--muted);">5 hours ago</div>
                  </div>
                </div>
              </div>
              <div class="notification-item" style="padding: 12px; border-radius: 8px; transition: background-color 0.2s ease; margin-top: 8px;">
                <div style="display: flex; gap: 12px;">
                  <div style="width: 40px; height: 40px; border-radius: 50%; background-color: #f59e0b; display: flex; align-items: center; justify-content: center; color: white;">ğŸ‚</div>
                  <div>
                    <div style="font-weight: bold;">Event</div>
                    <div style="font-size: 14px; color: #333;">Photography masterclass this weekend at Central Park</div>
                    <div style="font-size: 12px; color: var(--muted);">Yesterday</div>
                  </div>
                </div>
              </div>
            `;
          } else if (type === 'Favorites') {
            title.textContent = 'Favorites';
            if (favoritePosts.length > 0) {
              // å¦‚æœæœ‰æ”¶è—çš„å¸–å­ï¼Œæ˜¾ç¤ºæ”¶è—åˆ—è¡¨
              let favoritesHTML = '';
              favoritePosts.forEach(postId => {
                const post = document.querySelector(`[data-post-id="${postId}"]`).closest('.post');
                if (post) {
                  const userName = post.querySelector('strong').textContent;
                  const userImage = post.querySelector('img[alt]').src;
                  const postContent = post.querySelector('p').textContent;
                  const circleText = post.querySelector('small').textContent;
                  
                  favoritesHTML += `
                    <div class="favorite-post" style="padding: 12px; border-radius: 8px; border: 1px solid #eee; margin-bottom: 12px;">
                      <div style="display: flex; align-items: center; gap: 8px;">
                        <img src="${userImage}" alt="${userName}" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
                        <div>
                          <div style="font-weight: bold;">${userName}</div>
                          <div style="font-size: 12px; color: var(--muted);">${circleText}</div>
                        </div>
                      </div>
                      <div style="margin-top: 8px; font-size: 14px; color: #333;">${postContent}</div>
                    </div>
                  `;
                }
              });
              content.innerHTML = favoritesHTML;
            } else {
              // å¦‚æœæ²¡æœ‰æ”¶è—çš„å¸–å­ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
              content.innerHTML = `
                <div style="text-align: center; padding: 40px 20px; color: var(--muted);">
                  <div style="font-size: 48px; margin-bottom: 16px;">â˜…</div>
                  <div style="font-size: 18px; margin-bottom: 8px;">No favorites yet</div>
                  <div style="font-size: 14px;">Save posts you like by clicking the star icon</div>
                </div>
              `;
            }
          }
          
          header.appendChild(title);
          header.appendChild(closeBtn);
          panel.appendChild(header);
          panel.appendChild(content);
          
          // å…³é—­æŒ‰é’®äº‹ä»¶
          closeBtn.addEventListener('click', function() {
            togglePanel(panel);
          });
          
          return panel;
        }
        
        // åˆ‡æ¢é¢æ¿æ˜¾ç¤º/éšè—
        function togglePanel(panel) {
          if (activePanel && activePanel !== panel) {
            activePanel.style.display = 'none';
          }
          
          if (panel.style.display === 'block') {
            panel.style.display = 'none';
            activePanel = null;
          } else {
            panel.style.display = 'block';
            activePanel = panel;
            
            // æ·»åŠ æ˜¾ç¤ºåŠ¨ç”»
            panel.style.opacity = '0';
            panel.style.transform = 'translateY(20px)';
            panel.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
            
            setTimeout(() => {
              if (panel) {
                panel.style.opacity = '1';
                panel.style.transform = 'translateY(0)';
              }
            }, 10);
          }
        }
        
        // ä¸ºæ¯ä¸ªæ¶ˆæ¯é¡¹æ·»åŠ ç‚¹å‡»äº‹ä»¶
        messageItems.forEach(item => {
          console.log('Adding click event to message item:', item.textContent.trim());
          
          // ç¡®ä¿æ¶ˆæ¯é¡¹æœ‰æ­£ç¡®çš„æ ·å¼
          item.style.display = 'flex';
          item.style.flexDirection = 'column';
          item.style.alignItems = 'center';
          item.style.cursor = 'pointer';
          item.style.padding = '8px 16px';
          item.style.borderRadius = '8px';
          item.style.transition = 'background-color 0.2s ease';
          
          // æ‚¬åœæ•ˆæœ
          item.addEventListener('mouseenter', function() {
            this.style.backgroundColor = '#f0f4ff';
          });
          
          item.addEventListener('mouseleave', function() {
            this.style.backgroundColor = 'transparent';
          });
          
          item.addEventListener('click', function(e) {
            e.stopPropagation();
            console.log('Message item clicked:', this.textContent.trim());
            
            const type = this.querySelector('span').textContent;
            console.log('Panel type:', type);
            
            let panel = document.getElementById(`${type}-panel`);
            
            // å¦‚æœé¢æ¿ä¸å­˜åœ¨ï¼Œåˆ›å»ºé¢æ¿
            if (!panel) {
              panel = createMessagePanel(type);
              document.body.appendChild(panel);
              console.log('Created new panel:', panel.id);
            } else {
              console.log('Using existing panel:', panel.id);
            }
            
            // åˆ‡æ¢é¢æ¿æ˜¾ç¤º
            togglePanel(panel);
            
            // ç‚¹å‡»æ¶ˆæ¯ç”¨æˆ·æ—¶çš„äº¤äº’
            if (panel.querySelector('.message-conversation')) {
              const messageUsers = panel.querySelectorAll('.message-user');
              messageUsers.forEach(user => {
                user.addEventListener('click', function(e) {
                  e.stopPropagation();
                  const userName = this.querySelector('strong').textContent;
                  showNotification(`Opening chat with ${userName}...`);
                });
              });
            }
          });
        });
        
        // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹å…³é—­é¢æ¿
        document.addEventListener('click', function(e) {
          if (activePanel && !e.target.closest('.message-bar') && !e.target.closest('.message-panel')) {
            activePanel.style.display = 'none';
            activePanel = null;
          }
        });
      }
      
      // æ¨¡æ‹Ÿå¸–å­æ•°æ®ï¼Œç”¨äºæ¨è
      const postData = [
        {
          id: 5,
          user: 'Pro Baker',
          avatar: 'images/user5.jpg',
          circle: 'Bakery',
          time: '30m',
          content: 'Check out this amazing cake decoration technique I mastered!',
          image: 'images/cake.jpg',
          likes: 85,
          comments: 24,
          commentList: [
            { user: 'Baking Fan', content: 'Incredible! How long did this take?' },
            { user: 'Cake Lover', content: 'This is so beautiful! ğŸ‚' },
            { user: 'Pastry Chef', content: 'What kind of frosting did you use?' },
            { user: 'Home Baker', content: 'I need to try this technique!' }
          ]
        },
        {
          id: 6,
          user: 'Macro Photographer',
          avatar: 'images/user6.jpg',
          circle: 'Photography',
          time: '2h',
          content: 'Macro photography tips for capturing tiny details in nature.',
          image: 'images/macro.jpg',
          likes: 120,
          comments: 35,
          commentList: [
            { user: 'Nature Lover', content: 'These shots are amazing! What lens do you use?' },
            { user: 'Photography Enthusiast', content: 'Great tips, thank you!' },
            { user: 'Camera Geek', content: 'I recommend using a ring light for better results.' }
          ]
        },
        {
          id: 7,
          user: 'Acoustic Guitarist',
          avatar: 'images/user7.jpg',
          circle: 'Music',
          time: '4h',
          content: 'Just composed a new melody, would love your feedback!',
          image: 'images/guitar.jpg',
          likes: 67,
          comments: 18,
          commentList: [
            { user: 'Music Fan', content: 'Beautiful composition! ğŸ˜Š' }
          ]
        },
        {
          id: 8,
          user: 'Book Reviewer',
          avatar: 'images/user8.jpg',
          circle: 'Reading Club',
          time: '5h',
          content: 'My review of the latest bestseller everyone is talking about.',
          image: 'images/book.jpg',
          likes: 45,
          comments: 12,
          commentList: [
            { user: 'Reader', content: 'Thanks for the honest review!' },
            { user: 'Bookworm', content: 'I loved that book too!' },
            { user: 'Literary Critic', content: 'Interesting perspective on the character development.' },
            { user: 'Avid Reader', content: 'I disagree with your take on the ending.' },
            { user: 'Book Club Member', content: 'We discussed this at our last meeting!' }
          ]
        },
        {
          id: 9,
          user: 'Film Critic',
          avatar: 'images/user9.jpg',
          circle: 'Movies',
          time: '6h',
          content: 'Analysis of the cinematography in the latest blockbuster.',
          image: 'images/film.jpg',
          likes: 78,
          comments: 21,
          commentList: [
            { user: 'Movie Buff', content: 'Great analysis! I noticed that too.' },
            { user: 'Cinema Lover', content: 'Spot on! The visuals were stunning.' },
            { user: 'Film Student', content: 'This helped me understand the director\'s vision better.' }
          ]
        }
      ];
      
      // æ ¹æ®ç”¨æˆ·å…´è¶£æ¨èå¸–å­
      function recommendPosts() {
        // æ’åºå…´è¶£ï¼Œè·å–æµè§ˆé‡æœ€é«˜çš„ä¸»é¢˜
        const sortedInterests = Object.entries(userInterests)
          .sort(([,a], [,b]) => b - a);
        
        // æ ¹æ®ç”¨æˆ·å…´è¶£åˆ†æ•°åˆ†é…æƒé‡
        const recommendedPosts = postData.map(post => {
          // æ‰¾åˆ°å¸–å­æ‰€åœ¨åœˆå­çš„å…´è¶£åˆ†æ•°
          const interestScore = userInterests[post.circle] || 0;
          // è®¡ç®—æ¨èåˆ†æ•°ï¼ˆå…´è¶£åˆ†æ•° + äº’åŠ¨ç‡ï¼‰
          const engagementRate = (post.likes + post.comments * 2) / 10;
          post.relevanceScore = interestScore * 0.7 + engagementRate * 0.3;
          return post;
        }).sort((a, b) => b.relevanceScore - a.relevanceScore);
        
        return recommendedPosts;
      }
      
      // æ¸²æŸ“æ¨èå¸–å­
      function renderRecommendedPosts() {
        const discoverTab = document.getElementById('discover-tab');
        const recommendedPosts = recommendPosts();
        
        // æ·»åŠ æ¨èè¯´æ˜
        const recommendationNote = document.createElement('div');
        recommendationNote.className = 'recommendation-note';
        recommendationNote.style.padding = '12px 16px';
        recommendationNote.style.backgroundColor = 'rgba(43, 140, 255, 0.1)';
        recommendationNote.style.borderRadius = '8px';
        recommendationNote.style.marginBottom = '16px';
        recommendationNote.style.fontSize = '14px';
        recommendationNote.style.color = '#333';
        recommendationNote.innerHTML = '<strong>ğŸ“Š Recommended for you:</strong> Based on your interests in Photography and Bakery';
        discoverTab.appendChild(recommendationNote);
        
        // æ·»åŠ æ¨èå¸–å­
        recommendedPosts.forEach(post => {
          const postElement = document.createElement('section');
          postElement.className = 'post';
          
          // æ„å»ºè¯„è®ºHTML
          let commentsHTML = '';
          post.commentList.forEach(comment => {
            commentsHTML += `
              <div class="comment-item">
                <span class="comment-user">${comment.user}:</span>
                <span class="comment-content">${comment.content}</span>
              </div>
            `;
          });
          
          // å¤„ç†å¸–å­å†…å®¹ï¼Œç§»é™¤é‡å¤å¥å­å¹¶æ·»åŠ å›¾ç‰‡æè¿°
          let processedContent = post.content;
          
          // æ£€æŸ¥å¹¶ç§»é™¤é‡å¤å¥å­ï¼ˆç®€å•å®ç°ï¼šæŒ‰å¥å·åˆ†å‰²åå»é‡ï¼‰
          const sentences = processedContent.split('. ');
          if (sentences.length > 1) {
            const uniqueSentences = [];
            const seen = new Set();
            
            for (const sentence of sentences) {
              // åªä¿ç•™éç©ºå¥å­ä¸”æœªè§è¿‡çš„å¥å­
              if (sentence.trim() && !seen.has(sentence.trim())) {
                uniqueSentences.push(sentence);
                seen.add(sentence.trim());
              }
            }
            
            processedContent = uniqueSentences.join('. ');
            // ç¡®ä¿ä»¥å¥å·ç»“å°¾
            if (processedContent && !processedContent.endsWith('.')) {
              processedContent += '.';
            }
          }
          
          // ä¸ºä¸åŒç±»å‹çš„å›¾ç‰‡æ·»åŠ ç›¸åº”çš„ç®€çŸ­æè¿°
          let imageDescription = '';
          if (post.image.includes('cake')) {
            imageDescription = 'A beautifully decorated cake with intricate designs.';
          } else if (post.image.includes('macro')) {
            imageDescription = 'Close-up shot of tiny natural details with shallow depth of field.';
          } else if (post.image.includes('guitar')) {
            imageDescription = 'Acoustic guitar with warm wood tones in natural lighting.';
          } else if (post.image.includes('book')) {
            imageDescription = 'Stack of books with vibrant cover designs on wooden surface.';
          } else if (post.image.includes('film')) {
            imageDescription = 'Cinematography detail from a recent blockbuster film.';
          } else {
            imageDescription = 'Visual content related to the post topic.';
          }
          
          // æ„å»ºå¸–å­HTML
          postElement.innerHTML = `
            <button class="favorite-btn" data-post-id="post-recommend-${post.id}">â˜†</button>
            <div style="display: flex; align-items: center; gap: 8px;">
              <img src="${post.avatar}" alt="${post.user}" style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;">
              <strong>${post.user}</strong> <small style="color:var(--muted)">in ${post.circle} Â· ${post.time}</small>
            </div>
            <p>${processedContent}</p>
            <img src="${post.image}" alt="Post image">
            <p class="image-description" style="font-size: 12px; color: var(--muted); font-style: italic; margin-top: 4px;">${imageDescription}</p>
            <div class="post-actions">
                <button class="like-btn" data-post-id="${post.id}">
                  <span class="heart-icon">â¤</span>
                  <span class="like-count">${post.likes}</span>
                </button>
              <div class="comment-count" data-post-id="${post.id}">
                  <span class="comment-icon">ğŸ’¬</span>
                  <span class="count">${post.commentList.length}</span>
                </div>
            </div>
            <div class="comment-section">
                <input type="text" class="comment-input" placeholder="Add a comment..." data-post-id="${post.id}">
                  <button class="comment-submit" data-post-id="${post.id}">Post Comment</button>
                  <div class="comments-toggle" data-post-id="${post.id}">Show Comments (${post.commentList.length})</div>
                  <div class="comments-list" data-post-id="${post.id}" style="display: none;">
                    ${commentsHTML}
                    <button class="scroll-to-bottom" data-post-id="${post.id}">â–¼</button>
                </div>
              </div>
          `;
          
          discoverTab.appendChild(postElement);
        });
        
        // ä¸ºæ–°æ·»åŠ çš„å¸–å­åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
      updateCommentFeatures();
      initPostEvents();
      }
      
      // æ ‡ç­¾é¡µåˆ‡æ¢åŠŸèƒ½
      function setupTabNavigation() {
        const navButtons = document.querySelectorAll('.nav-btn');
        const tabs = document.querySelectorAll('.feed-tab');
        
        navButtons.forEach(button => {
          button.addEventListener('click', () => {
            const tabId = button.getAttribute('data-tab');
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            navButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            
            // æ›´æ–°æ ‡ç­¾é¡µçŠ¶æ€
            tabs.forEach(tab => tab.classList.remove('active'));
            document.getElementById(`${tabId}-tab`).classList.add('active');
            
            // å¦‚æœæ˜¯å‘ç°æ ‡ç­¾ä¸”å†…å®¹ä¸ºç©ºï¼Œåˆ™æ¸²æŸ“æ¨èå¸–å­
            if (tabId === 'discover' && document.getElementById('discover-tab').children.length <= 1) {
              renderRecommendedPosts();
            }
          });
        });
      }
      
      // åˆå§‹åŒ–å¸–å­äº‹ä»¶ç›‘å¬ - ç®€åŒ–ç‰ˆæœ¬ï¼Œåªç”¨äºæ–°æ·»åŠ çš„å¸–å­
      function initPostEvents() {
        // ä¸ºæ–°æ·»åŠ çš„å…ƒç´ åº”ç”¨ç›¸åŒçš„äº‹ä»¶å¤„ç†
        setupLikeButtons();
        setupCommentSubmitButtons();
        setupCommentCountClick();
        setupCommentsToggle();
        setupScrollToBottomButtons();
      }
      
      // æ›´æ–°ç”¨æˆ·å…´è¶£ï¼ˆæ¨¡æ‹Ÿç”¨æˆ·äº¤äº’ï¼‰
      function updateUserInterest(circle, increment = 5) {
        if (userInterests[circle]) {
          userInterests[circle] += increment;
          // ç¡®ä¿ä¸è¶…è¿‡100
          userInterests[circle] = Math.min(100, userInterests[circle]);
        }
      }
      
      // ç»Ÿä¸€çš„ç‚¹èµåŠŸèƒ½å¤„ç†
      function setupLikeButtons() {
        document.querySelectorAll('.like-btn').forEach(btn => {
          const newBtn = btn.cloneNode(true);
          btn.parentNode.replaceChild(newBtn, btn);
          
          newBtn.addEventListener('click', function(event) {
            event.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
            const postId = this.getAttribute('data-post-id');
            const countEl = this.querySelector('.like-count');
            let count = parseInt(countEl.textContent);
            
            // åˆ‡æ¢ç‚¹èµçŠ¶æ€
            if (this.classList.contains('liked')) {
              count--;
              this.classList.remove('liked');
            } else {
              count++;
              this.classList.add('liked');
            }
            
            countEl.textContent = count;
          });
        });
      }
      
      // ç»Ÿä¸€çš„è¯„è®ºæäº¤åŠŸèƒ½å¤„ç†
      function setupCommentSubmitButtons() {
        document.querySelectorAll('.comment-submit').forEach(btn => {
          const newBtn = btn.cloneNode(true);
          btn.parentNode.replaceChild(newBtn, btn);
          
          newBtn.addEventListener('click', function(event) {
            event.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
            const postId = this.getAttribute('data-post-id');
            const input = this.previousElementSibling;
            const comment = input.value.trim();
            if (comment) {
              const listEl = document.querySelector(`.comments-list[data-post-id="${postId}"]`);
              const commentItem = document.createElement('div');
              commentItem.className = 'comment-item';
              
              // åˆ›å»ºç”¨æˆ·åå’Œè¯„è®ºå†…å®¹å…ƒç´ 
              const userNameSpan = document.createElement('span');
              userNameSpan.className = 'comment-user';
              userNameSpan.textContent = 'You:';
              
              const commentContentSpan = document.createElement('span');
              commentContentSpan.className = 'comment-content';
              commentContentSpan.textContent = comment;
              
              commentItem.appendChild(userNameSpan);
              commentItem.appendChild(commentContentSpan);
              
              // æ·»åŠ æ–°è¯„è®ºçš„åŠ¨ç”»æ•ˆæœ
              commentItem.style.opacity = '0';
              commentItem.style.transform = 'translateX(-10px)';
              commentItem.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
              
              listEl.appendChild(commentItem);
              
              // è§¦å‘é‡æ’ååº”ç”¨åŠ¨ç”»
              setTimeout(() => {
                commentItem.style.opacity = '1';
                commentItem.style.transform = 'translateX(0)';
              }, 10);
              
              input.value = '';
              
              // æ›´æ–°è¯„è®ºæ•°é‡
              const commentCountEl = document.querySelector(`.comment-count[data-post-id="${postId}"] .count`);
              let count = parseInt(commentCountEl.textContent);
              count++;
              commentCountEl.textContent = count;
              
              // Update comment toggle button text
              const toggleBtn = document.querySelector(`.comments-toggle[data-post-id="${postId}"]`);
              if (toggleBtn.textContent.includes('Show Comments')) {
                toggleBtn.textContent = `Show Comments (${count})`;
              } else {
                toggleBtn.textContent = `Hide Comments`;
                
                // æ·»åŠ ä¸€ä¸ªä¸´æ—¶é€šçŸ¥ï¼Œæ˜¾ç¤º"è¯„è®ºå·²æ·»åŠ "
                const notification = document.createElement('div');
                notification.textContent = 'Comment added!';
                notification.style.cssText = 'position: fixed; bottom: 20px; right: 20px; background: var(--accent); color: white; padding: 10px 15px; border-radius: 6px; z-index: 1000; box-shadow: 0 4px 12px rgba(0,0,0,0.15);';
                document.body.appendChild(notification);
                setTimeout(() => {
                  notification.style.opacity = '0';
                  notification.style.transition = 'opacity 0.5s ease';
                  setTimeout(() => {
                    notification.remove();
                  }, 500);
                }, 2000);
              }
              
              // è‡ªåŠ¨æ»šåŠ¨åˆ°æ–°è¯„è®º
              if (listEl.style.display !== 'none') {
                listEl.scrollTop = listEl.scrollHeight;
              }
            }
          });
        });
      }
      
      // ç»Ÿä¸€çš„è¯„è®ºè®¡æ•°ç‚¹å‡»åŠŸèƒ½å¤„ç†
      function setupCommentCountClick() {
        document.querySelectorAll('.comment-count').forEach(element => {
          const newElement = element.cloneNode(true);
          element.parentNode.replaceChild(newElement, element);
          
          newElement.addEventListener('click', function(event) {
            event.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
            const postId = this.getAttribute('data-post-id');
            const commentInput = document.querySelector(`.comment-input[data-post-id="${postId}"]`);
            commentInput.focus();
          });
        });
      }
      
      // ç»Ÿä¸€åˆå§‹åŒ–æ‰€æœ‰äº‹ä»¶
      function initAllEvents() {
        // ç§»é™¤æ—§çš„äº‹ä»¶ç›‘å¬å™¨çš„æœ€ä½³æ–¹å¼æ˜¯é‡æ–°åˆ›å»ºå…ƒç´ 
        setupLikeButtons();
        setupCommentSubmitButtons();
        setupCommentCountClick();
        setupCommentsToggle();
        setupScrollToBottomButtons();
      }
      
      // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', function() {
        // åˆå§‹åŒ–æ ‡ç­¾é¡µå¯¼èˆª
        setupTabNavigation();
        
        // åˆå§‹åŒ–æ‰€æœ‰äº‹ä»¶ï¼ˆåªæ‰§è¡Œä¸€æ¬¡ï¼‰
        initAllEvents();
        
        // ç›‘å¬å¸–å­ç‚¹å‡»ï¼Œæ›´æ–°ç”¨æˆ·å…´è¶£
        document.querySelectorAll('.post').forEach(post => {
          post.addEventListener('click', function(event) {
            // å¦‚æœç‚¹å‡»çš„æ˜¯äº¤äº’å…ƒç´ ï¼Œä¸æ›´æ–°å…´è¶£
            if (event.target.closest('.like-btn, .comment-submit, .comment-count, .comments-toggle, .scroll-to-bottom')) {
              return;
            }
            
            const circleText = this.querySelector('small').textContent;
            const circleMatch = circleText.match(/in ([\w\s]+)/);
            if (circleMatch && circleMatch[1]) {
              const circle = circleMatch[1].split(' Â·')[0];
              updateUserInterest(circle);
            }
          });
        });
        
        // åˆå§‹åŒ–æ–°åŠŸèƒ½
        initFavoriteButtons();
        initSearch();
        initCreatePost();
        initMessageBar();
        initPullToRefresh();
      });
      
      // ç»Ÿä¸€çš„è¯„è®ºå±•å¼€/æ”¶èµ·åŠŸèƒ½
      function setupCommentsToggle() {
        document.querySelectorAll('.comments-toggle').forEach(element => {
          // ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§äº‹ä»¶ç›‘å¬å™¨
          const newElement = element.cloneNode(true);
          element.parentNode.replaceChild(newElement, element);
          
          newElement.addEventListener('click', function(event) {
            event.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
            const postId = this.getAttribute('data-post-id');
            const commentsList = document.querySelector(`.comments-list[data-post-id="${postId}"]`);
            const commentCount = document.querySelector(`.comment-count[data-post-id="${postId}"] .count`).textContent;
            
            try {
              if (commentsList.style.display === 'none' || commentsList.style.display === '') {
                // é‡ç½®æ‰€æœ‰æ ·å¼
                commentsList.style = '';
                commentsList.style.display = 'block';
                commentsList.style.opacity = '0';
                commentsList.style.transform = 'translateY(-10px)';
                commentsList.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                commentsList.style.maxHeight = '300px';
                commentsList.style.overflowY = 'auto';
                commentsList.style.position = 'relative';
                
                // è§¦å‘é‡æ’ååº”ç”¨åŠ¨ç”»
                setTimeout(() => {
                  if (commentsList) { // å†æ¬¡æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨
                    commentsList.style.opacity = '1';
                    commentsList.style.transform = 'translateY(0)';
                  }
                }, 10);
                
                this.textContent = 'Hide Comments';
                this.classList.add('active');
              } else {
                // æ·»åŠ æ”¶èµ·åŠ¨ç”»
                commentsList.style.opacity = '0';
                commentsList.style.transform = 'translateY(-10px)';
                
                setTimeout(() => {
                  if (commentsList) { // å†æ¬¡æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨
                    commentsList.style.display = 'none';
                  }
                }, 300);
                
                this.textContent = `Show Comments (${commentCount})`;
                this.classList.remove('active');
              }
            } catch (error) {
              console.error('Error in comment toggle:', error);
            }
          });
        });
      }
      
      // ç»Ÿä¸€çš„æ»šåŠ¨åˆ°åº•éƒ¨åŠŸèƒ½
      function setupScrollToBottomButtons() {
        document.querySelectorAll('.scroll-to-bottom').forEach(button => {
          // ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§äº‹ä»¶ç›‘å¬å™¨
          const newButton = button.cloneNode(true);
          button.parentNode.replaceChild(newButton, button);
          
          newButton.addEventListener('click', function(event) {
            event.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
            // è·å–å¯¹åº”çš„è¯„è®ºåˆ—è¡¨
            const postId = this.getAttribute('data-post-id');
            const commentsList = document.querySelector(`.comments-list[data-post-id="${postId}"]`);
            
            try {
              if (commentsList) {
                // ç¡®ä¿è¯„è®ºåˆ—è¡¨æœ‰æ»šåŠ¨åŠŸèƒ½
                commentsList.style.maxHeight = '300px';
                commentsList.style.overflowY = 'auto';
                commentsList.style.position = 'relative';
                
                // ç›´æ¥æ»šåŠ¨åˆ°åº•éƒ¨
                commentsList.scrollTop = commentsList.scrollHeight;
                
                // è§†è§‰åé¦ˆ
                this.style.transform = 'scale(0.9)';
                setTimeout(() => {
                  if (this) { // å†æ¬¡æ£€æŸ¥æŒ‰é’®æ˜¯å¦å­˜åœ¨
                    this.style.transform = 'scale(1)';
                  }
                }, 150);
              }
            } catch (error) {
              console.error('Error in scroll to bottom:', error);
            }
          });
        });
      }
      
      // æ›´æ–°è¯„è®ºåŠŸèƒ½ï¼Œç”¨äºæ–°æ·»åŠ çš„å¸–å­ - ç°åœ¨ä½¿ç”¨å®Œæ•´çš„åˆå§‹åŒ–å‡½æ•°
      function updateCommentFeatures() {
        initPostEvents();
      }
    </script>
  <footer style="text-align: center; font-size: 16px;">
    Â© 2025 Hobby Circle â€” Connect With Your Passions
    <div class="contact-info">
      <p>contact us: <a href="mailto:contact@hobbycircle.com">contact@hobbycircle.com</a></p>
    </div>
  </footer>
    </body>
</html>